<!DOCTYPE html>
<html>
<title>Demo</title>
<link rel="shortcut icon" href="images/icon.png"/>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
<link rel="shortcut icon" href="images/icon.png"/>
<script src="lib/d3.v5.min.js"></script>
<script src="https://d3js.org/d3.v4.js"></script>
<script src="https://d3js.org/d3-color.v1.min.js"></script>
<script src="https://d3js.org/d3-interpolate.v1.min.js"></script>
<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
<script src="https://d3js.org/d3-scale.v3.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script src="https://cdn.jsdelivr.net/npm/lodash@4.17.4/lodash.min.js"></script>
<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

<link rel="stylesheet" href="styles/main.css">
<link rel="stylesheet" href="styles/sidebar.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
    body, h1, h2, h3, h4, h5, h6 {
        font-family: "Raleway", sans-serif
    }
</style>
<body class="w3-light-grey">

<!-- Sidebar/menu -->
<nav class="w3-sidebar w3-collapse w3-white w3-animate-left" style="z-index:3;width:200px;" id="mySidebar"><br>
    <div class="w3-container">
        <a href="#" onclick="w3_close()" class="w3-hide-large w3-right w3-jumbo w3-padding w3-hover-grey"
           title="close menu">
            <i class="fa fa-remove"></i>
        </a>
        <h4><b>MalViz</b></h4>
    </div>
    <div class="w3-bar-block">
        <a href="#portfolio" onclick="w3_close()" class="w3-bar-item w3-button w3-padding w3-text-teal"><i
                class="fa fa-th-large fa-fw w3-margin-right"></i>PORTFOLIO</a>
        <a href="#about" onclick="w3_close()" class="w3-bar-item w3-button w3-padding"><i
                class="fa fa-user fa-fw w3-margin-right"></i>ABOUT</a>
        <a href="#contact" onclick="w3_close()" class="w3-bar-item w3-button w3-padding"><i
                class="fa fa-envelope fa-fw w3-margin-right"></i>CONTACT</a>
    </div>
</nav>

<!-- Overlay effect when opening sidebar on small screens -->
<div class="w3-overlay w3-hide-large w3-animate-opacity" onclick="w3_close()" style="cursor:pointer"
     title="close side menu" id="myOverlay"></div>

<!-- !PAGE CONTENT! -->
<div class="w3-main" style="margin-left:200px">

    <!-- Header -->
    <header id="portfolio">
        <a href="#"></a>
        <span class="w3-button w3-hide-large w3-xxlarge w3-hover-text-grey" onclick="w3_open()"><i
                class="fa fa-bars"></i></span>
        <div class="w3-container">
            <h1>Malware Visualization</h1>
            <div class="w3-section w3-bottombar w3-padding-16">
                <span class="w3-margin-right">Select dataset:</span>
                <span class="selection">
    <select id="selectmalware" class="selectmalware">
        <option>--Select dataset--</option>

        <option value="Moi-Win7-RemoteAccess_1.CSV">Moi-Win7-RemoteAccess_1</option>
        <option value="Moi-Win7-RemoteAccess_2.CSV">Moi-Win7-RemoteAccess_2</option>
        <option value="Moi-Win7-RemoteAccess_3.CSV">Moi-Win7-RemoteAccess_3</option>
        <option value="Moi-Win7-RemoteAccess_4.CSV">Moi-Win7-RemoteAccess_4</option>
        <option value="Moi-Win7-RemoteAccess_5.CSV">Moi-Win7-RemoteAccess_5</option>
        <option value="Moi-Win7-RemoteAccess_6.CSV">Moi-Win7-RemoteAccess_6</option>
          <option value="Moi-Win7-RemoteAccess_7.CSV">Moi-Win7-RemoteAccess_7</option>
        <option value="Moi-XP-RemoteAccess_1.CSV">Moi-XP-RemoteAccess_1</option>
        <option value="Moi-XP-RemoteAccess_2.CSV">Moi-XP-RemoteAccess_2</option>
        <option value="Moi-XP-RemoteAccess_3.CSV">Moi-XP-RemoteAccess_3</option>
        <option value="Moi-XP-RemoteAccess_4.CSV">Moi-XP-RemoteAccess_4</option>
        <option value="Moi-XP-RemoteAccess_5.CSV">Moi-XP-RemoteAccess_5</option>
        <option value="Moi-XP-RemoteAccess_6.CSV">Moi-XP-RemoteAccess_6</option>
        <option value="Moi-XP-RemoteAccess_7_exec.CSV">Moi-XP-RemoteAccess_7_exec</option>
        <option value="Moi-XP-RemoteAccess_7_install.CSV">Moi-XP-RemoteAccess_7_install</option>

        <option value="faran-7-vs-backdoor-9.CSV">faran-7-vs-backdoor-9</option>
        <option value="faran-7-vs-backdoor-10.CSV">faran-7-vs-backdoor-10</option>
        <option value="faran-7-vs-backdoor-11.CSV">faran-7-vs-backdoor-11</option>
        <option value="faran-7-vs-backdoor-12.CSV">faran-7-vs-backdoor-12</option>
        <option value="faran-7-vs-backdoor-13.CSV">faran-7-vs-backdoor-13</option>
        <option value="faran-7-vs-backdoor-14.CSV">faran-7-vs-backdoor-14</option>
        <option value="faran-7-vs-backdoor-15.CSV">faran-7-vs-backdoor-15</option>
        <option value="Faran-win7-vs-7fa0ef3f22045c45c80885865d0d0942.CSV">Faran-win7-vs-7fa0ef3f22045c45c80885865d0d0942</option>
         <option value="Faran-win7-vs-13ef35e912a54739a27015eecc3fbbaeaf2ba2b7a2a49bfd11e26e099a330926.CSV">Faran-win7-vs-13ef35e912a54739a27015eecc3fbbaeaf2ba2b7a2a49bfd11e26e099a330926</option>
        <option value="Vung-Win7-Bladabindi.CSV">Vung-Win7-Bladabindi</option>
        <option value="Vung-Win7-Cryptowall.CSV">Vung-Win7-Cryptowall</option>
        <option value="Vung-Win7-Locky.Gen.CSV">Vung-Win7-Locky.Gen</option>
        <option value="Vung-Win7-Multinjector.CSV">Vung-Win7-Multinjector</option>
        <option value="Vung-Win7-Teerac.B.CSV">Vung-Win7-Teerac.B</option>
        <option value="VungPham-Behavior-Bladabindi.gen-XP.CSV">VungPham-Behavior-Bladabindi.gen-XP</option>
        <option value="VungPham-Behavior-MultiInjector-XP.CSV">VungPham-Behavior-MultiInjector-XP</option>
        <option value="VungPham-Behavior-Vawtrak.A-XP.CSV">VungPham-Behavior-Vawtrak.A-XP</option>
        <option value="VungPham-Behavior-Winwebsec.I.CSV">VungPham-Behavior-Winwebsec.I</option>
        <option value="Vung-Behavior-XP-Payment copy.CSV">Vung-Behavior-XP-Payment copy</option>
        <option value="Vung-Behavior-XP-RemR.CSV">Vung-Behavior-XP-RemR</option>
        <option value="Vung-Behavior-XP-Scan copy (alloyanycut).CSV">Vung-Behavior-XP-Scan-copy-(alloyanycut)</option>


        <option> - - - - - - - Filtered log files - - - - - - - </option>

        <option value="Faran-Trojan-Backdoor.win32.BlueIce.CSV">Faran-Trojan-Backdoor.win32.BlueIce</option>
        <option value="Faran-Trojan-Backdoor.Win32.CyberSpy.13.b.CSV">Faran-Trojan-Backdoor.Win32.CyberSpy.13.b</option>
        <option value="Faran-Trojan-Backdoor.win32.Death.25.i.CSV">Faran-Trojan-Backdoor.win32.Death.25.i</option>
        <option value="Faran-Trojan-Backdoor.win32.executor.a.CSV">Faran-Trojan-Backdoor.win32.executor.a</option>
        <option value="Faran-win7-Trojan-Backdoor.Win32.Alicia.o.CSV">Faran-win7-Trojan-Backdoor.Win32.Alicia.o</option>
        <option value="Faran-win7-Trojan-Backdoor.win32.Executor.a.CSV">Faran-win7-Trojan-Backdoor.win32.Executor.a</option>

        <option value="Huyen-Ransomware-WannaPeace.csv">Huyen-Ransomware-WannaPeace</option>
        <option value="Huyen-Trojan-Infostealer.Dexter.csv">Huyen-Trojan-Infostealer.Dexter</option>

        <option value="Vung-Email-Flooder-Absolut-XP.CSV">Vung-Email-Flooder-Absolut-XP</option>
        <option value="Vung-Email-Flooder-Achis-Win10.CSV">Vung-Email-Flooder-Achis-Win10</option>
        <option value="Vung-Email-Flooder-Achis-XP.CSV">Vung-Email-Flooder-Achis-XP</option>
        <option value="Vung-Email-Flooder-Archis-Win7.CSV">Vung-Email-Flooder-Archis-Win7</option>
        <option value="Vung-HackTool-BackSteal-Win10.CSV">Vung-HackTool-BackSteal-Win10</option>
        <option value="Vung-HackTool-EmailCrack1-Win10.CSV">Vung-HackTool-EmailCrack1-Win10</option>
        <option value="Vung-HackTool-EmailCrack-Win10.CSV">Vung-HackTool-EmailCrack-Win10</option>
        <option value="Vung-HackTool-EmailCrack-XP.CSV">Vung-HackTool-EmailCrack-XP</option>
        <option value="Vung-HackTool-Stealm1-Win10.CSV">Vung-HackTool-Stealm1-Win10</option>
        <option value="Vung-HackTool-Stealm-Win10.CSV">Vung-HackTool-Stealm-Win10</option>


    </select>
    </span>
            </div>
        </div>
    </header>

    <!-- First Photo Grid-->
    <div class="w3-row-padding">
        <div class="w3-third w3-container w3-margin-bottom">
            <div class="w3-container w3-white" id="stats">

            </div>
        </div>
        <div class="w3-third w3-container w3-margin-bottom">

            <div class="w3-container w3-white">
                Hello
                <p><b>Lorem Ipsum</b></p>
                <p>Praesent tincidunt sed tellus ut rutrum. Sed vitae justo condimentum, porta lectus vitae, ultricies
                    congue gravida diam non fringilla.</p>
            </div>
        </div>
        <div class="w3-third w3-container">

            <div class="w3-container w3-white">
                <p><b>Lorem Ipsum</b></p>
                <p>Praesent tincidunt sed tellus ut rutrum. Sed vitae justo condimentum, porta lectus vitae, ultricies
                    congue gravida diam non fringilla.</p>
            </div>
        </div>
    </div>

    <!-- Second Photo Grid-->
    <div class="w3-row-padding">
        <div class="w3-third w3-container w3-margin-bottom">
            <div class="w3-container w3-white">
                <p><b>Lorem Ipsum</b></p>
                <p>Praesent tincidunt sed tellus ut rutrum. Sed vitae justo condimentum, porta lectus vitae, ultricies
                    congue gravida diam non fringilla.</p>
            </div>
        </div>
        <div class="w3-third w3-container w3-margin-bottom">
            <div class="w3-container w3-white">
                <p><b>Lorem Ipsum</b></p>
                <p>Praesent tincidunt sed tellus ut rutrum. Sed vitae justo condimentum, porta lectus vitae, ultricies
                    congue gravida diam non fringilla.</p>
            </div>
        </div>
        <div class="w3-third w3-container">
            <div class="w3-container w3-white">
                <p><b>Lorem Ipsum</b></p>
                <p>Praesent tincidunt sed tellus ut rutrum. Sed vitae justo condimentum, porta lectus vitae, ultricies
                    congue gravida diam non fringilla.</p>
            </div>
        </div>
    </div>


    <!-- Images of Me -->

    <div class="w3-container w3-padding-large" style="margin-bottom:32px">
        <h4><b>About Me</b></h4>
        <p>Just me, myself and I, exploring the universe of unknownment. I have a heart of love and an interest of lorem
            ipsum and mauris neque quam blog. I want to share my world with you. Praesent tincidunt sed tellus ut
            rutrum. Sed vitae justo condimentum, porta lectus vitae, ultricies congue gravida diam non fringilla.
            Praesent tincidunt sed tellus ut rutrum. Sed vitae justo condimentum, porta lectus vitae, ultricies congue
            gravida diam non fringilla.</p>
        <hr>

        <h4>Technical Skills</h4>
        <!-- Progress bars / Skills -->
        <p>Photography</p>
        <div class="w3-grey">
            <div class="w3-container w3-dark-grey w3-padding w3-center" style="width:95%">95%</div>
        </div>
        <p>Web Design</p>
        <div class="w3-grey">
            <div class="w3-container w3-dark-grey w3-padding w3-center" style="width:85%">85%</div>
        </div>
        <p>Photoshop</p>
        <div class="w3-grey">
            <div class="w3-container w3-dark-grey w3-padding w3-center" style="width:80%">80%</div>
        </div>
        <p>
            <button class="w3-button w3-dark-grey w3-padding-large w3-margin-top w3-margin-bottom">
                <i class="fa fa-download w3-margin-right"></i>Download Resume
            </button>
        </p>
        <hr>

        <h4>How much I charge</h4>
        <!-- Pricing Tables -->
        <div class="w3-row-padding" style="margin:0 -16px">
            <div class="w3-third w3-margin-bottom">
                <ul class="w3-ul w3-border w3-white w3-center w3-opacity w3-hover-opacity-off">
                    <li class="w3-black w3-xlarge w3-padding-32">Basic</li>
                    <li class="w3-padding-16">Web Design</li>
                    <li class="w3-padding-16">Photography</li>
                    <li class="w3-padding-16">1GB Storage</li>
                    <li class="w3-padding-16">Mail Support</li>
                    <li class="w3-padding-16">
                        <h2>$ 10</h2>
                        <span class="w3-opacity">per month</span>
                    </li>
                    <li class="w3-light-grey w3-padding-24">
                        <button class="w3-button w3-teal w3-padding-large w3-hover-black">Sign Up</button>
                    </li>
                </ul>
            </div>

            <div class="w3-third w3-margin-bottom">
                <ul class="w3-ul w3-border w3-white w3-center w3-opacity w3-hover-opacity-off">
                    <li class="w3-teal w3-xlarge w3-padding-32">Pro</li>
                    <li class="w3-padding-16">Web Design</li>
                    <li class="w3-padding-16">Photography</li>
                    <li class="w3-padding-16">50GB Storage</li>
                    <li class="w3-padding-16">Endless Support</li>
                    <li class="w3-padding-16">
                        <h2>$ 25</h2>
                        <span class="w3-opacity">per month</span>
                    </li>
                    <li class="w3-light-grey w3-padding-24">
                        <button class="w3-button w3-teal w3-padding-large w3-hover-black">Sign Up</button>
                    </li>
                </ul>
            </div>

            <div class="w3-third">
                <ul class="w3-ul w3-border w3-white w3-center w3-opacity w3-hover-opacity-off">
                    <li class="w3-black w3-xlarge w3-padding-32">Premium</li>
                    <li class="w3-padding-16">Web Design</li>
                    <li class="w3-padding-16">Photography</li>
                    <li class="w3-padding-16">Unlimited Storage</li>
                    <li class="w3-padding-16">Endless Support</li>
                    <li class="w3-padding-16">
                        <h2>$ 25</h2>
                        <span class="w3-opacity">per month</span>
                    </li>
                    <li class="w3-light-grey w3-padding-24">
                        <button class="w3-button w3-teal w3-padding-large w3-hover-black">Sign Up</button>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Contact Section -->
    <div class="w3-container w3-padding-large w3-grey">
        <h4 id="contact"><b>Contact Me</b></h4>
        <div class="w3-row-padding w3-center w3-padding-24" style="margin:0 -16px">
            <div class="w3-third w3-dark-grey">
                <p><i class="fa fa-envelope w3-xxlarge w3-text-light-grey"></i></p>
                <p>email@email.com</p>
            </div>
            <div class="w3-third w3-teal">
                <p><i class="fa fa-map-marker w3-xxlarge w3-text-light-grey"></i></p>
                <p>Chicago, US</p>
            </div>
            <div class="w3-third w3-dark-grey">
                <p><i class="fa fa-phone w3-xxlarge w3-text-light-grey"></i></p>
                <p>512312311</p>
            </div>
        </div>
        <hr class="w3-opacity">
        <form action="/action_page.php" target="_blank">
            <div class="w3-section">
                <label>Name</label>
                <input class="w3-input w3-border" type="text" name="Name" required>
            </div>
            <div class="w3-section">
                <label>Email</label>
                <input class="w3-input w3-border" type="text" name="Email" required>
            </div>
            <div class="w3-section">
                <label>Message</label>
                <input class="w3-input w3-border" type="text" name="Message" required>
            </div>
            <button type="submit" class="w3-button w3-black w3-margin-bottom"><i
                    class="fa fa-paper-plane w3-margin-right"></i>Send Message
            </button>
        </form>
    </div>

    <!-- Footer -->
    <footer class="w3-container w3-padding-32 w3-dark-grey">
        <div class="w3-row-padding">
            <div class="w3-third">
                <h3>FOOTER</h3>
                <p>Praesent tincidunt sed tellus ut rutrum. Sed vitae justo condimentum, porta lectus vitae, ultricies
                    congue gravida diam non fringilla.</p>
                <p>Powered by <a href="https://www.w3schools.com/w3css/default.asp" target="_blank">w3.css</a></p>
            </div>

            <div class="w3-third">
                <h3>BLOG POSTS</h3>
                <ul class="w3-ul w3-hoverable">
                    <li class="w3-padding-16">
                        <span class="w3-large">Lorem</span><br>
                        <span>Sed mattis nunc</span>
                    </li>
                    <li class="w3-padding-16">
                        <span class="w3-large">Ipsum</span><br>
                        <span>Praes tinci sed</span>
                    </li>
                </ul>
            </div>

            <div class="w3-third">
                <h3>POPULAR TAGS</h3>
                <p>
                    <span class="w3-tag w3-black w3-margin-bottom">Travel</span> <span
                        class="w3-tag w3-grey w3-small w3-margin-bottom">New York</span> <span
                        class="w3-tag w3-grey w3-small w3-margin-bottom">London</span>
                    <span class="w3-tag w3-grey w3-small w3-margin-bottom">IKEA</span> <span
                        class="w3-tag w3-grey w3-small w3-margin-bottom">NORWAY</span> <span
                        class="w3-tag w3-grey w3-small w3-margin-bottom">DIY</span>
                    <span class="w3-tag w3-grey w3-small w3-margin-bottom">Ideas</span> <span
                        class="w3-tag w3-grey w3-small w3-margin-bottom">Baby</span> <span
                        class="w3-tag w3-grey w3-small w3-margin-bottom">Family</span>
                    <span class="w3-tag w3-grey w3-small w3-margin-bottom">News</span> <span
                        class="w3-tag w3-grey w3-small w3-margin-bottom">Clothing</span> <span
                        class="w3-tag w3-grey w3-small w3-margin-bottom">Shopping</span>
                    <span class="w3-tag w3-grey w3-small w3-margin-bottom">Sports</span> <span
                        class="w3-tag w3-grey w3-small w3-margin-bottom">Games</span>
                </p>
            </div>

        </div>
    </footer>

    <div class="w3-black w3-center w3-padding-24">Powered by <a href="https://www.w3schools.com/w3css/default.asp"
                                                                title="W3.CSS" target="_blank" class="w3-hover-opacity">w3.css</a>
    </div>

    <!-- End page content -->
</div>
<script src="js/ultility.js"></script>
<script src="js/main.js"></script>
<script>
    // Script to open and close sidebar
    function w3_open() {
        document.getElementById("mySidebar").style.display = "block";
        document.getElementById("myOverlay").style.display = "block";
    }

    function w3_close() {
        document.getElementById("mySidebar").style.display = "none";
        document.getElementById("myOverlay").style.display = "none";
    }

    let divOperation = d3.select("body").append("div")
        .attr("class", "tooltip")
        .style("opacity", 0);

    let div = d3.select("body").append("div")
        .attr("class", "tooltip")
        .style("opacity", 0);

    let div2 = d3.select("body").append("div")
        .attr("class", "tooltip2")
        .style("opacity", 0);

    let div3 = d3.select("body").append("div")
        .attr("class", "tooltip3")
        .style("opacity", 0);

    $('select#selectmalware').on('change', function (e) {
        let optionSelected = $("option:selected", this);
        let valueSelected = this.value;
        let loading = d3.select('body').append('div').attr('id', 'loading');
        loading.append('img').attr('id', 'loading-image').attr('src', 'images/loader2.gif');
        init(valueSelected);

    });
    let init = function (filePath) {
        d3.queue()
            .defer(d3.csv, "data/" + filePath, function (d) {
                return {
                    Timestamp: d['Time_of_Day'],
                    PID: d['PID'],
                    Process_Name: d['Process_Name'],
                    Operation: d["Operation"],
                    Path: d["Path"],
                    Detail: d["Detail"]
                }
            })
            .defer(d3.csv, "data/domain.csv")
            // .defer(d3.csv, "metadata/infosec.csv")
            .await(function (error, original_data, domain) {
                if (error) {
                    console.error('Oh dear, something went wrong: ' + error);
                }
                else {
                    let data = ProcessDataV2(original_data, domain);
                    // let malist = handleOperation(rawList);
                    let SiteManager = applicationManager(data); //Initialize application
                    SiteManager.drawStats('#stats'); //Draw statistic map
                    // SiteManager.drawStats2('#OperationList'); //Draw statistic map
                    // SiteManager.drawMain('#heatmap');//Draw mainMap
                    // SiteManager.highlight('#avaiop'); // hightlight
                    // let maxcalls = SiteManager.getCallRange().maxcall;
                    // SiteManager.updateDomainBox('#maliciousdomain');
                    // $("#btnName").click(function () {
                    //         SiteManager.sort2DMatrix('similarity')
                    //     }
                    // );
                    // $("#btnNum").click(function () {
                    //         SiteManager.sort2DMatrix('numlinks')
                    //     }
                    // );
                    // $("#btnCount").click(function () {
                    //         SiteManager.sort2DMatrix('numcount')
                    //     }
                    // );
                    // // $("#btnSimilarity").click( function()
                    // //     {
                    // //         SiteManager.sort2DMatrix('similarity')
                    // //     }
                    // // );
                    // $(function () {
                    //     let handle = $("#custom-handle");
                    //     $("#slider").slider({
                    //         min: 0,
                    //         value: 3,
                    //         max: maxcalls,
                    //         create: function () {
                    //             handle.text($(this).slider("value"));
                    //         },
                    //         slide: function (event, ui) {
                    //             $("#amount").val("Min: " + ui.value + " - Max: " + maxcalls);
                    //             handle.text(ui.value);
                    //             SiteManager.updateRangeFilter(ui.value, maxcalls)
                    //         }
                    //     });
                    //     $("#amount").val("Min: " + 3 + " - Max: " + maxcalls);
                    // });
                    //
                    // SiteManager.updateRangeFilter(3, maxcalls);
                    // isready = true;
                }
            });
    };
    init("Huyen-Ransomware-WannaPeace.csv");
    window.onbeforeunload = function () {
        window.scrollTo(0, 0);
    }
    var list = {
        "CloseFile": {"operation": "FileSystem", "index": 0},
        "CreateFile": {"operation": "FileSystem", "index": 1},
        "CreateFileMapping": {"operation": "FileSystem", "index": 2},
        "DeviceIoControl": {"operation": "FileSystem", "index": 3},
        "FileSystemControl": {"operation": "FileSystem", "index": 4},
        "FlushBuffersFile": {"operation": "FileSystem", "index": 5},
        "LockFile": {"operation": "FileSystem", "index": 6},
        "NotifyChangeDirectory": {"operation": "FileSystem", "index": 7},
        "QueryAllInformationFile": {"operation": "FileSystem", "index": 8},
        "QueryAttributeInformationVolume": {"operation": "FileSystem", "index": 9},
        "QueryAttributeTagFile": {"operation": "FileSystem", "index": 10},
        "QueryBasicInformationFile": {"operation": "FileSystem", "index": 11},
        "QueryDeviceRelations": {"operation": "FileSystem", "index": 12},
        "QueryDirectory": {"operation": "FileSystem", "index": 13},
        "QueryEAFile": {"operation": "FileSystem", "index": 14},
        "QueryEaInformationFile": {"operation": "FileSystem", "index": 15},
        "QueryFileInternalInformationFile": {"operation": "FileSystem", "index": 16},
        "QueryFullSizeInformationVolume": {"operation": "FileSystem", "index": 17},
        "QueryInformationVolume": {"operation": "FileSystem", "index": 18},
        "QueryNameInformationFile": {"operation": "FileSystem", "index": 19},
        "QueryNetworkOpenInformationFile": {"operation": "FileSystem", "index": 20},
        "QueryNormalizedNameInformationFile": {"operation": "FileSystem", "index": 21},
        "QueryObjectIdInformationVolume": {"operation": "FileSystem", "index": 22},
        "QueryOpen": {"operation": "FileSystem", "index": 23},
        "QueryPositionInformationFile": {"operation": "FileSystem", "index": 24},
        "QueryRemoteProtocolInformation": {"operation": "FileSystem", "index": 25},
        "QuerySecurityFile": {"operation": "FileSystem", "index": 26},
        "QuerySizeInformationVolume": {"operation": "FileSystem", "index": 27},
        "QueryStandardInformationFile": {"operation": "FileSystem", "index": 28},
        "QueryStreamInformationFile": {"operation": "FileSystem", "index": 29},
        "ReadFile": {"operation": "FileSystem", "index": 30},
        "SetAllocationInformationFile": {"operation": "FileSystem", "index": 31},
        "SetBasicInformationFile": {"operation": "FileSystem", "index": 32},
        "SetDispositionInformationFile": {"operation": "FileSystem", "index": 33},
        "SetEndOfFileInformationFile": {"operation": "FileSystem", "index": 34},
        "SetPositionInformationFile": {"operation": "FileSystem", "index": 35},
        "SetRenameInformationFile": {"operation": "FileSystem", "index": 36},
        "SetSecurityFile": {"operation": "FileSystem", "index": 37},
        "UnlockFileSingle": {"operation": "FileSystem", "index": 38},
        "WriteFile": {"operation": "FileSystem", "index": 39},
        "InternalDeviceIoControl": {"operation": "FileSystem", "index": 40},
        "System Statistics": {"operation": "FileSystem", "index": 41},
        "SystemControl": {"operation": "FileSystem", "index": 42},
        "Load Image": {"operation": "ProcessThread", "index": 0},
        "Process Create": {"operation": "ProcessThread", "index": 1},
        "Process Exit": {"operation": "ProcessThread", "index": 2},
        "Process Start": {"operation": "ProcessThread", "index": 3},
        "Thread Create": {"operation": "ProcessThread", "index": 4},
        "Thread Exit": {"operation": "ProcessThread", "index": 5},
        "RegCloseKey": {"operation": "Registry", "index": 0},
        "RegCreateKey": {"operation": "Registry", "index": 1},
        "RegDeleteKey": {"operation": "Registry", "index": 2},
        "RegDeleteValue": {"operation": "Registry", "index": 3},
        "RegEnumKey": {"operation": "Registry", "index": 4},
        "RegEnumValue": {"operation": "Registry", "index": 5},
        "RegFlushKey": {"operation": "Registry", "index": 6},
        "RegLoadKey": {"operation": "Registry", "index": 7},
        "RegOpenKey": {"operation": "Registry", "index": 8},
        "RegQueryKey": {"operation": "Registry", "index": 9},
        "RegQueryKeySecurity": {"operation": "Registry", "index": 10},
        "RegQueryMultipleValueKey": {"operation": "Registry", "index": 11},
        "RegQueryValue": {"operation": "Registry", "index": 12},
        "RegSetInfoKey": {"operation": "Registry", "index": 13},
        "RegSetKeySecurity": {"operation": "Registry", "index": 14},
        "RegSetValue": {"operation": "Registry", "index": 15},
        "TCP Accept": {"operation": "Network", "index": 0},
        "TCP Connect": {"operation": "Network", "index": 1},
        "TCP Disconnect": {"operation": "Network", "index": 2},
        "TCP Receive": {"operation": "Network", "index": 3},
        "TCP Reconnect": {"operation": "Network", "index": 4},
        "TCP Retransmit": {"operation": "Network", "index": 5},
        "TCP Send": {"operation": "Network", "index": 6},
        "TCP TCPCopy": {"operation": "Network", "index": 7},
        "UDP Receive": {"operation": "Network", "index": 8},
        "UDP Accept": {"operation": "Network", "index": 9},
        "UDP Connect": {"operation": "Network", "index": 10},
        "UDP Send": {"operation": "Network", "index": 11},
        "Process Profiling": {"operation": "Profiling", "index": 0},
        "Others": {"operation": "Others", "index": 0}
    };
    var colorScaleOrange = d3.scaleSequential(d3["interpolateYlOrBr"])// File: 0-38
        .domain([70, -30]);

    var colorScaleGreen = d3.scaleSequential(d3["interpolateGreens"]) // Registry: 0-14
        .domain([20, -3]);

    var colorScaleBlue = d3.scaleSequential(d3["interpolateBlues"])  // Process: 0-5
        .domain([8, -2]);

    var colorScaleRed = d3.scaleSequential(d3["interpolateReds"]) // Network: 0-9
        .domain([15, -5]);

    function getProcessName(operation) {
        if (!list[operation]) {
            return "Others"
        } else return list[operation]["operation"]
            ;
    }

    var sub = d3.keys(list);

    function colorPicker(operation) {
        if (list[operation]) {
            switch (list[operation]["operation"]) {
                case "FileSystem":
                    return colorScaleOrange(list[operation]["index"]);
                case "Registry":
                    return colorScaleGreen(list[operation]["index"]);
                case "Network":
                    return colorScaleRed(list[operation]["index"]);
                case "ProcessThread":
                    return colorScaleBlue(list[operation]["index"]);
                case "Profiling":
                    return "#6854b1";
                default:
                    return "#5d5d5d"
            }
        } else return "#5d5d5d"
    }
</script>

</body>
</html>
